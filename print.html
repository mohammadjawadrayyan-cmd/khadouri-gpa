<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุดูุงุฏุฉ ุงููุนุฏู โ PTUK</title>
  <meta name="robots" content="noindex, nofollow" />
  <link rel="stylesheet" href="print.css" />
</head>
<body>
  <div class="page">
    <div class="actions noprint">
      <button id="btnPrint">ุทุจุงุนุฉ</button>
      <a href="index.html">ุฑุฌูุน ูููููุน</a>
    </div>

    <header class="head">
      <div class="logo">
        <div class="badge"><span>PTUK</span></div>
        <div class="titles">
          <div class="t1">Palestine Technical University โ Kadoorie</div>
          <div class="t2">ุฌุงูุนุฉ ููุณุทูู ุงูุชูููุฉ โ ุฎุถูุฑู</div>
        </div>
      </div>

      <div class="meta">
        <div class="meta__row"><span>ุงูุชุงุฑูุฎ</span><strong id="pDate">โ</strong></div>
        <div class="meta__row"><span>ุงููููุน</span><strong>khadouri-gpa</strong></div>
      </div>
    </header>

    <section class="box">
      <h1 class="h1">ุดูุงุฏุฉ ุญุณุงุจ ุงููุนุฏู</h1>
      <p class="sub">
        ูุฐู ุงูุดูุงุฏุฉ ุชูุธูุฑ ุชูุงุตูู ููุงุฏ ุงููุตู ูุงููุนุฏู ุงููุตูู ูุงูุชุฑุงููู (ูุธุงู 100).
      </p>
    </section>

    <section class="box">
      <h2 class="h2">ููุงุฏ ุงููุตู</h2>
      <div class="table">
        <div class="thead">
          <div>ุงุณู ุงููุงุฏุฉ</div>
          <div class="c">ุงูุณุงุนุงุช</div>
          <div class="c">ุงูุนูุงูุฉ</div>
          <div class="c">ุงููุชูุฌุฉ</div>
          <div class="c">ููุนุงุฏุฉุ</div>
        </div>
        <div id="pRows" class="tbody"></div>
      </div>
      <div class="hint">
        * ุงููุงุฏุฉ ุงูููุนุงุฏุฉ ูุชู ุงุญุชุณุงุจูุง ุจุทุฑููุฉ ุงูุงุณุชุจุฏุงู ุฅุฐุง ูุงูุช ุงูุนูุงูุฉ ุงูุณุงุจูุฉ ูุญุณูุจุฉ ุถูู ุงูุชุฑุงููู ุงูุณุงุจู.
      </div>
    </section>

    <section class="grid">
      <div class="box">
        <h2 class="h2">ูุนุฏู ุงููุตู ุงูุญุงูู</h2>
        <div class="big" id="pSemAvg">โ</div>
        <div class="mini" id="pSemMeta">โ</div>
      </div>

      <div class="box">
        <h2 class="h2">ุงููุนุฏู ุงูุชุฑุงููู</h2>
        <div class="big" id="pCumAvg">โ</div>
        <div class="mini" id="pCumMeta">โ</div>
        <div id="pCongrats" class="congrats" hidden>ูุจุฑูู! ููุฏ ุชุญุณู ูุนุฏูู ุงูุชุฑุงููู ๐</div>
      </div>
    </section>

    <footer class="foot">
      <div class="sign">
        <div class="line"></div>
        <div class="name">Mohammad Jawad</div>
        <div class="role">Signature</div>
      </div>

      <div class="copy">
        ยฉ Mohammad Jawad. All rights reserved.
        <div class="url">https://mohammadjawadrayyan-cmd.github.io/khadouri-gpa/</div>
      </div>
    </footer>
  </div>

  <script>
    const $ = (s) => document.querySelector(s);

    function esc(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;");
    }

    function load(){
      const raw = localStorage.getItem("khadouri_gpa_data");
      if(!raw){
        $("#pRows").innerHTML = '<div class="empty">ูุง ุชูุฌุฏ ุจูุงูุงุช ููุทุจุงุนุฉ. ุงุฑุฌุน ูููููุน ูุงุญุณุจ ุงููุนุฏู ุฃููุงู.</div>';
        return;
      }

      let data;
      try{ data = JSON.parse(raw); }catch(e){
        $("#pRows").innerHTML = '<div class="empty">ุจูุงูุงุช ุงูุทุจุงุนุฉ ุชุงููุฉ. ุงุญุณุจ ูู ุฌุฏูุฏ.</div>';
        return;
      }

      $("#pDate").textContent = data.date || "โ";

      // Rows
      const rows = Array.isArray(data.courses) ? data.courses : [];
      if(rows.length === 0){
        $("#pRows").innerHTML = '<div class="empty">ูุง ุชูุฌุฏ ููุงุฏ.</div>';
      } else {
        $("#pRows").innerHTML = rows.map(r => {
          const rep = r.repeat ? "ูุนู" : "ูุง";
          const status = r.status || (r.grade >= 60 ? "ูุงุฌุญ" : "ุฑุงุณุจ");
          return `
            <div class="trow">
              <div>${esc(r.name)}</div>
              <div class="c">${esc(r.credits)}</div>
              <div class="c">${esc(r.grade)}</div>
              <div class="c ${status === "ุฑุงุณุจ" ? "bad": "good"}">${esc(status)}</div>
              <div class="c">${rep}</div>
            </div>
          `;
        }).join("");
      }

      // Semester
      if(data.semester){
        $("#pSemAvg").textContent = (data.semester.avg ?? "โ");
        $("#pSemMeta").textContent = `ุฅุฌูุงูู ุณุงุนุงุช ุงููุตู: ${data.semester.hours ?? "โ"} โ ${data.semester.label ?? ""}`;
      }

      // Cumulative
      if(data.cumulative && data.cumulative.ok){
        $("#pCumAvg").textContent = data.cumulative.avg ?? "โ";
        $("#pCumMeta").textContent = `Total Hours: ${data.cumulative.hours ?? "โ"} โ ${data.cumulative.label ?? ""}`;
        if(data.cumulative.improved) $("#pCongrats").hidden = false;
      } else {
        $("#pCumAvg").textContent = "โ";
        $("#pCumMeta").textContent = "ูู ูุชู ุญุณุงุจ ุงูุชุฑุงููู.";
      }
    }

    $("#btnPrint").addEventListener("click", () => window.print());
    load();
  </script>
</body>
</html>
